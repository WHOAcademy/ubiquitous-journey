# Over rides for default values in Helm Charts
destination: &ci_cd_ns labs-ci-cd

##############
# 🛎 Jenkins Custom Values
#############
jenkins_values: &jenkins_values
  source_secrets: {}
  sealed_secrets:
    - name: git-auth
      username: AgCMg+BCEvd2LaKMcQz0PYxf0t+KYvKXG6RBVPJiu+LBhXcIZQB6NnM870YpcKgLcehJoAUEN9xt/kLNR+Ko5eC5A2ruMj+OqRJ/0ElzYyRtSoP+I8vvWVQxQFkU/QNH7HuuBcNcGjWi4b2f4/rcVu4dbOmc3wtCb8v+eWFpO986rK6jMFt3hf1b21iPPNXdWgTvNbMMMgWtGKItkfRnngRZ3izkcFz3rW9fM2gvW0pvNJnqxZ6cFzmLFwdVk/xyKj1CQceqzSSLkTmZsdSKBmaFm85OdlXqlCzl7S+oVcHvsuTWoxfSR8YfvJfo0rh6S75q/3xBOcMiMMT7uxJ241gCT31fHyzuk+19pk7ue6e0NBv5b97nKGSEQ5ErN+ndSscuk5+1o1GjzfImIVC0HCys+Ikc330XJqAR9nVr9siQg0ZBKq2H4pyB0VMFtYs7PnnqplbZp72EKSd2Fc8vvvyDj4wKINFc/5++KQWVFtwd44mdkudwkKBKmury0+7NCcGbxs9NE+gDQCWHO6Ing8Xr1AtU6IoLvg0S6O9PoB410SaBHZxOqAXcIhwElWWjqQGIQE+xx9IKqrzSqsGvFaXbwrkq8BRcx1chfoYkCie9nGcU1Op0DfmJtJrr16cQ9JxCEnGaKeiLbvbkg2qx2v2EHhAq66nSa9WMCJobjYhu2ZuHjVFwwETU8rPJYqDffhDydzIcoxOb+6HjAQ==
      password: AgBw0VA8ebYuSoekE9HfkIBtbDJjCW9BP6r0ywzG3HExnqhMQNxo8NtYGhRslLQXybvjCMVo5ECgBbALho5kkGfLtS6mYQ0lGgDvnKkeKcjFt0J5UqYj0/+VVjZap7V7e4KQws7LMPeOL6WGh8S7d/k0BVv83wEILBzwb2kchjuoZ8Ql8sQjkFflgNHQUCUthUoL+6cbM3t6qrrvexaZ8OFC5zrLWiQ/WpMLgZ+HJFePjIkFb9/zrBsEFZNtpI5xf64UviPtzKOwAFg6i+fzaTF/jv1BkvU+cu+u/S95f292LSzt4so9dMXlAuG7gxZjiZYGnWxJtG+RYlsz6V9D4DW+RxQo2Dsi2Y1/CT9SBIdH+f1/K6nhBEUOOBrCuNLjOOqGeb9CtRTUAAe+qcTZLiVlKH6SgZl9OdUYMJAbBk9EaErVe/GR+xa5P8/i/QaC0YdG8pBacTDM2MIlEJdwc9lnzCta30dO7KX+raYYVMW/fIDSiACk7kZzfeZg/Vici3fW8RczKQsssqrvm10eZYcdXBODK7PTKnVuHASF04gA1ghqzdp089NA3PveQznonl7vV+1GnLr7c0pdqvJ5bVXkkhWQ9ZJ5OE51mWfPUqviu5QWR2R9yi8NGQjTbOWsVRTbrbJK/g81G1L97ipEq6SfO6Wa7jfFfV2pN+jvs9maLOiF604SUkPVPFdMMCUm5dArhO9DTkD+kIYmjeIcsh8ScsLgHDNAOGwwvms/Z/r2gCn5sEd4DoX3
    - name: nexus-password
      password: AgByvIFbFw2SMMVY/ZRm4j5nKBWqxlLMdGLiwMJsr9NkPc2P3zz6wOa3y1oYYPAiB//0fje949v2wfS3Uu28/B47O/l6HFGNSrbxNjHp+6gepB2x7g8h7WHpDF8pi9NR2jeyZJBrYJbYiiRJr5+h8WbLQg9E0QozQzK3ZCMiTkR4AFhGZpyFV+pDoRSnjOyfVxMPVMmI2IR6jfgT3BKAVQEQPDeAbZEePEG18GIaJzH8tQ0lUtkVln/pS57igZLJhmE59cOx9sC+oCXwRXFqOvkN3C84XVwdyQop7+zJbMIIfruhtji7HwEK4zadE+gZsFMrrukT+Etc23cCMA8+4dLB48QCE4R0nYmGyLFtbErJAGqERS+kpgfnG+jH14l684y6ZOzYftllYAmKFvO72cVROyvhJzqvUmMpqiM8QVw96+2gjMRiVbXMn+4jgJrjKZo0KhlRxxP/2G9HpLYji4KjiorP9BoQ+d23uxUelRLcN/aVOlYDNoWybhpOEfxdw6Scqhs3QU1HwLkWAG1X5vFpcX6uwzDOYhxKbDICUcbRw5sdaGWU0K/jn4iRols2KzjsRYbV3XQ36no9Vs4xbUfEm9sTAO2iYCHzwLgavkCc+G/4cD8DKaML87UwtMljtTibhbLBDIIVocD4cp9Pb5IRItZ8tmlfrCv6uSW6wJ3tbGlJq89iurZXCY5QhYc3w582ubdBS/2sPo3VAkHJYsE=
      username: AgBSSR9F4wuPA2axmRU1QfKyC+Pr7GpP4PK/Gwwx4YmhJxV4Ory7X7YXG56/lMmpskwShHXStIkho3zO8FgtS7XyfnphVIoyUOF0Bagtf2GHIyizmxKX4nrg5wuKiVi+iFvWGn7A0/1sxS7hDNp3Qxbl9Kfnyu2p/ew3jwGJhT2TPnHNIKXwKBWthNFbqrzCIDSI8X/Ch7UNZheb+XKhC8PNCIEk628MSozb7RCwXO/rvmzs1uofNnXWMAtp3szjaSekrVsQ/n9/IZi/6BiJDhV2zXwgFA4OtB4p5lpakwGYpulJvqP9nOisfnrFw82EFUl9fHP7MFNtxcBRqsAAsWMMTkdv2INZgBkjPezSfOkAra0XTLt/rPDNGazPpncYmAd3wRoZ5GkwgBpMYDwKaMblTZH956y4ZacXDESRx0KHbRsvT94FVV4BliwOTEAkO4jLcaOHTwz+VBQ0c/BwhHf00smF7VTduL9WhXRhLgL3Ls38B1ovHPXbR2Yt1z5uaoryzPH0dfjNs+n9leEkttJaHLXXNKD5vsErMy9TFNigwhBZXFF8OeTz/lu4Lnf8SUvAXvUhrAUo/PiilS5/JdWKxoSZeG2nOc4h/b6Ru7/IXk68jysqNJzzaNdS1qQ8wxmv9oI1e6qCxlj3HOR5HUOjIDqGRVJf4irFtYh5kRW9htyWHObqz8CNQDLNBNLo7/vxcZXjfPlya+JjFit3gLuP
    - name: sonarqube-token
      token: AgBiIq7njYNT1XNte3VYQINsbiZZpxlUB7Lf10rxMNwmxGvhFUSu14pH7gzC3Py0rXxTG1nVCj9CHC4H9CK3fXM3e9QiUwWk7q2NbTtHJou+Tr8Le5tbvYGFTM/rV9ucEaqCm5n66Mv8srHamJSV464ikxlxQxQryikQYWd5vePgJe0PPJWHGLhp5+q9hU+2ica7qESJEixQgfglFAC8+8N2svPq8ZBKiJCWJQnovFOVtEQ8wbv98EQU0B6nStuN0+v3chIYbiAA4dADsruvFR+Yk1muxGHZeHpOOsOQRIAZ1a4Zph1foD1b0AxLtT+vm2+DvL4NLSwCysGc+icVYVwe4YRxOjRLDmHIclE9kyi4V34sqC/ssYWIh+x1ijU/NJcVreR2/ryrCs+4KzROk5hOue1VpuCuQHcrkPSeGHtDeNDiyyXZBEYj1GFmyH56fhHrAoZ5v2VlvVvShSyMXC5FbYMAxrg0c9ty5VZ79ysO1827h1FvK10cRbw5uldHrZogQB0/60h6H65qlDnaDNk5nL5ATf9zExlgh6+sQoKYWwdSGGKqu0dbLbK1VWjcE7fBhJhAlINvCdLJC7yD7csxIJCCaFCLoDjzvBg3awddaFE6FI7m/kopz6ltAT7q819esYg/SoxVt1oqCYhynm8NkezOCnT8LnlKPHpO6PA4dJSAvpZ35tkl0RHaKg69VhPR+za3O9nLPqhpNyClUpE9xVuLu3THpqMwhV3YbfD0zVCrRcSpjsRV
  deployment:
    openshiftauth: true
    imagestream:
      name: jenkins
      tag: latest
    limits:
      memory_request: 2Gi
      memory_limit: 6Gi
      cpu_request: 500m
      cpu_limit: 2
    env_vars:
      - name: JVM_ARCH
        value: 'x86_64'
      - name: DISABLE_ADMINISTRATIVE_MONITORS
        value: 'false'
      - name: ENABLE_FATAL_ERROR_LOG_FILE
        value: 'false'
      - name: JENKINS_OPTS
        value: '--sessionTimeout=180'
      - name: GITHUB_ACCOUNT
        value: 'WHOAcademy'
      - name: GITHUB_ORG
        value: 'true'
      - name: GITHUB_TOKEN
        value: "TODO_ADD_TOKEN"
  buildconfigs:
    # Jenkins S2I from Red Hat Labs
    - name: jenkins
      build_trigger_secret: 'shhhhh-this-is-my-super-duper-secret123-shhhhh'
      strategy_type: "Source"
      source_secret: 'git-auth'
      pull_secret: ''
      source_repo: https://github.com/rht-labs/s2i-config-jenkins.git
      source_repo_ref: v1.9
      source_context_dir: '/'
      builder_image_kind: "DockerImage"
      builder_image_name: quay.io/openshift/origin-jenkins
      builder_image_tag: "4.4.0"
    # Jenkins agents for running builds etc
    - name: "jenkins-agent-mvn"
      source_context_dir: "jenkins-agents/jenkins-agent-mvn"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
      builder_image_name: "quay.io/eformat/origin-jenkins-agent-maven"
      builder_image_tag: "latest"
    - name: "jenkins-agent-helm"
      source_context_dir: "jenkins-agents/jenkins-agent-helm"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-argocd"
      source_context_dir: "jenkins-agents/jenkins-agent-argocd"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-arachni"
      source_context_dir: "jenkins-agents/jenkins-agent-arachni"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-golang"
      source_context_dir: "jenkins-agents/jenkins-agent-golang"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-gradle"
      source_context_dir: "jenkins-agents/jenkins-agent-gradle"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-image-mgmt"
      source_context_dir: "jenkins-agents/jenkins-agent-image-mgmt"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-mongodb"
      source_context_dir: "jenkins-agents/jenkins-agent-mongodb"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-npm"
      source_context_dir: "jenkins-agents/jenkins-agent-npm"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-python"
      source_context_dir: "jenkins-agents/jenkins-agent-python"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-python38"
      source_context_dir: "jenkins-agents/jenkins-agent-python"
      source_repo: "https://github.com/WHOAcademy/containers-quickstarts"
      source_repo_ref: "feature/python38"
    - name: "jenkins-agent-ruby"
      source_context_dir: "jenkins-agents/jenkins-agent-ruby"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-ansible"
      source_context_dir: "jenkins-agents/jenkins-agent-ansible"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-conftest"
      source_context_dir: "jenkins-agents/jenkins-agent-conftest"
      source_repo: "https://github.com/redhat-cop/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-zap"
      source_context_dir: "jenkins-agents/jenkins-agent-zap"
      source_repo: "https://github.com/WHOAcademy/containers-quickstarts"
      source_repo_ref: "master"
    - name: "jenkins-agent-sonarqube"
      source_context_dir: "jenkins-agents/jenkins-agent-sonarqube"
      source_repo: "https://github.com/WHOAcademy/containers-quickstarts"
      source_repo_ref: "master"
  imagestreams:
    - name: jenkins
    - name: jenkins-agent-mvn
    - name: jenkins-agent-argocd
    - name: jenkins-agent-helm
    - name: jenkins-agent-ansible
    - name: jenkins-agent-arachni
    - name: jenkins-agent-golang
    - name: jenkins-agent-gradle
    - name: jenkins-agent-image-mgmt
    - name: jenkins-agent-mongodb
    - name: jenkins-agent-npm
    - name: jenkins-agent-python
    - name: jenkins-agent-python38
    - name: jenkins-agent-ruby
    - name: jenkins-agent-conftest
    - name: jenkins-agent-zap
    - name: jenkins-agent-sonarqube

##############
# 🛎 Pact Broker Custom Values
#############
pact_broker_values: &pact_broker_values
  secrets:
    name: pact-broker-secrets
    keys:
      pactBrokerDatabaseUsername: pact_broker_database_username
      pactBrokerDatabasePassword: pact_broker_database_password
      pactBrokerAdmin: pact_broker_admin
      pactBrokerAdminPassword: pact_broker_admin_password
      pactBrokerBasicAuthUsername: pact_broker_user
      pactBrokerBasicAuthPassword: pact_broker_user_password
    values:
      pactBrokerDatabaseUsername: pact_broker_user
      pactBrokerDatabasePassword: thisisdefinitelynotmypassword
      pactBrokerAdmin: admin
      pactBrokerAdminPassword: thisisdefinitelynotmypassword
      pactBrokerBasicAuthUsername: dev
      pactBrokerBasicAuthPassword: thisisdefinitelynotmypassword

##############
# 🛎 Zalenium Custom Values
#############
## TODO: Update source URL as upstream when ArgoCD version is greater 1.5.0 or above
zalenium_values: &zalenium_values
  hub:
    serviceType: ClusterIP
    openshift:
      deploymentConfig:
        enabled: true
      route:
        enabled: true
    persistence:
      enabled: false
    serviceAccount:
      create: false
    desiredContainers: 0
    podAnnotations:
      app: zalenium

##############
# 🛎 Hoverfly Custom Values
# Values reference https://github.com/helm/charts/tree/master/incubator/hoverfly
#############
hoverfly_values: &hoverfly_values
  replicaCount: "1"
  openshift:
    route:
      admin:
        enabled: true
        hostname: ""
      proxy:
        enabled: true
        hostname: ""

##############
# 🛎 Wekan Custom Values
# Values reference https://github.com/wekan/wekan/tree/master/helm/wekan
#############
wekan_values: &wekan_values
  service:
    type: ClusterIP
  autoscaling:
    enabled: false
  mongodb-replicaset:
    replicas: 1
    securityContext:
      runAsUser: ""
      fsGroup: ""
  ingress:
    enabled: false
  route:
    enabled: true

postgresql_values: &postgresql_values
  database: test

mysql_values: &mysql_values
  primary:
    podSecurityContext:
      enabled: false
    containerSecurityContext:
      enabled: false
    persistence:
      enabled: false
  secondary:
    podSecurityContext:
      enabled: false
    containerSecurityContext:
      enabled: false
    persistence:
      enabled: false
  auth:
    rootPassword: pAssw0rd
    database: test
    username: test_user
    password: password  # TODO: encrypt data

##############
# 🛎 Mattermost Custom Values
# Values reference https://github.com/mattermost/mattermost-helm
#############
mattermost_values: &mattermost_values
  route:
    enabled: true
  mysql:
    mysqlRootPassword: "mysqlpass"
    mysqlUser: "mattermost"
    mysqlPassword: "matterpass"
  configJSON: {
      "ServiceSettings": {
        "EnablePostUsernameOverride": true,
        "EnablePostIconOverride": true,
      },
      "TeamSettings": {
        "EnableUserCreation": true,
        "EnableOpenServer": false,
      }
    }

##############
# 🛎 Nexus Custom Values
# Values reference https://github.com/redhat-cop/helm-charts/tree/master/charts/sonatype-nexus
#############
nexus_values: &nexus_values
  persistence:
    accessMode: ReadWriteOnce
    enabled: true
    storageSize: 20Gi

##############
# 🐙 Argo Ignore Differences
#############
jenkins_ignore_differences: &jenkins_ignore_differences
  ignoreDifferences:
  - group: apps.openshift.io
    kind: DeploymentConfig
    jsonPointers:
    - /spec/template/spec/containers/0/image
    - /spec/triggers/0/imageChangeParams/lastTriggeredImage
  - group: build.openshift.io
    kind: BuildConfig
    jsonPointers:
    - /spec/triggers

nexus_ignore_differences: &nexus_ignore_differences
  ignoreDifferences:
  - group: route.openshift.io
    kind: Route
    jsonPointers:
    - /status/ingress

hoverflyignore_differences: &hoverfly_ignore_differences
  ignoreDifferences:
  - group: route.openshift.io
    kind: Route
    jsonPointers:
    - /status/ingress
    - /spec/host
  - group: apps/v1
    kind: Deployment
    jsonPointers:
    - /spec/replicas

crw_ignore_differences: &crw_ignore_differences
  ignoreDifferences:
  - group: org.eclipse.che
    kind: CheCluster
    jsonPointers:
    - /spec


mongodb_ignore_differences: &mongodb_ignore_differences
  ignoreDifferences:
  - group: apps.openshift.io
    kind: DeploymentConfig
    jsonPointers:
      - /spec/template/spec/containers/0/image
##############
# 🐙 Argo Sync Policy
#############
sync_policy_true: &sync_policy_true
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
      #validate: true # disable it due to argo-operator update, Argo CD 2.0 don't have this flag

sync_policy_no_selfheal: &sync_policy_no_selfheal
  syncPolicy:
    automated:
      prune: true
      selfHeal: false
      #validate: true # disable it due to argo-operator update, Argo CD 2.0 don't have this flag

##############
# 🛎 Argo App of Apps declaration
#############

# enabled true on an app is to tell helm to create an argo app cr for this item
applications:
  - name: nexus
    enabled: true
    source: https://redhat-cop.github.io/helm-charts/
    chart_name: sonatype-nexus
    source_path: ""
    source_ref: "1.0.0"
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    values:
      *nexus_values
    ignore_differences: *nexus_ignore_differences
  - name: jenkins
    enabled: true
    source: https://github.com/redhat-cop/helm-charts.git
    source_path: charts/jenkins
    source_ref: "jenkins-0.0.20"
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    values:
      *jenkins_values
    ignore_differences: *jenkins_ignore_differences
  - name: pact-broker
    enabled: false
    source: https://github.com/redhat-cop/helm-charts.git
    source_path: charts/pact-broker
    source_ref: "pact-broker-0.0.2"
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    values:
      *pact_broker_values
  - name: sonarqube
    enabled: true
    source: https://github.com/redhat-cop/helm-charts.git
    source_path: charts/sonarqube
    source_ref: "sonarqube-0.0.13"
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
  - name: crw
    enabled: false
    destination: crw
    source: https://github.com/rht-labs/refactored-adventure
    source_path: crw/base
    source_ref: master
    sync_policy:
      *sync_policy_no_selfheal
    no_helm: true
    ignore_differences: *crw_ignore_differences
  - name: zalenium
    enabled: true
    source: https://github.com/zalando/zalenium.git
    source_path: charts/zalenium
    source_ref: "master"
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    values:
      *zalenium_values
  - name: hoverfly
    enabled: false
    source: https://github.com/helm/charts.git
    source_path: incubator/hoverfly
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    source_ref: "master"
    values:
      *hoverfly_values
    ignore_differences: *hoverfly_ignore_differences
  - name: wekan
    enabled: false
    source: https://github.com/wekan/wekan.git
    source_path: helm/wekan
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    source_ref: "v4.01"
    values:
      *wekan_values
  - name: tekton
    enabled: false
    destination: crw
    source: https://github.com/rht-labs/refactored-adventure
    source_path: tekton/base
    source_ref: master
    sync_policy:
      *sync_policy_true
    no_helm: true
  - name: mattermost
    enabled: false
    source: https://github.com/mattermost/mattermost-helm.git
    source_path: charts/mattermost-team-edition
    destination: *ci_cd_ns
    source_ref: "mattermost-team-edition-3.10.0"
    values:
      *mattermost_values
  - name: etherpad
    enabled: false
    source: https://github.com/redhat-cop/helm-charts.git
    source_path: charts/etherpad
    destination: *ci_cd_ns
    source_ref: "etherpad-0.0.1"
    sync_policy:
      *sync_policy_true
  - name: mongodb
    enabled: true
    source: https://whoacademy.github.io/helm-charts/
    chart_name: mongodb
    source_path: ""
    source_ref: "1.0.2"
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    ignore_differences: *mongodb_ignore_differences
  - name: postgresql
    enabled: true
    source: https://whoacademy.github.io/helm-charts/
    chart_name: postgresql
    source_path: ""
    source_ref: "1.0.0"
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    values: *postgresql_values
  - name: mysql
    enabled: true
    source: https://charts.bitnami.com/bitnami
    chart_name: mysql
    source_path: ""
    source_ref: "8.0.0"
    sync_policy:
      *sync_policy_true
    destination: *ci_cd_ns
    values: *mysql_values
